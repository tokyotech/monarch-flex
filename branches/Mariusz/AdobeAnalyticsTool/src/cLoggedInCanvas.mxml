<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="showCanvasHandler(event)" show="showCanvasHandler(event)" width="1013" height="625" backgroundAlpha="0.1" backgroundColor="#FFFFFF" xmlns:local="*">
	<mx:Metadata>
		[Event(name="CreateCommunityGroupEvent", type="cCreateCommunityGroupEvent")]
		[Event(name="RequestWebsiteStatsEvent", type="cWebsiteGraphicClickedEvent")]
		[Event(name="OpenWebsiteCreatorWindowEvent", type="cCreateWebsiteEvent")]
		[Event(name="EditWebsiteLabelClickedEvent", type="cEditWebsiteEvent")]
	</mx:Metadata>
	
	<mx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
		
			///////////////////////////////////////////////////////////////////////////////////
			//
			//							GUI EVENT HANDLERS
			//
			///////////////////////////////////////////////////////////////////////////////////
		
			/**
			 * 	Function which switches the mMyCommViewStack index to 0 (home).
			 */
			private function createCommBackLabelClickedHandler(event:Event):void
			{
				mMyCommViewStack.selectedIndex = 0;
			}
			
			/**
			 * Function which switches the mMyCommViewStack index to 2 (website browser).
			 */
			private function WebsiteBrowserBackClickedHandler(event:Event):void
			{
				mMyCommViewStack.selectedIndex = 2;
			}
			
			/**
			 * 	Function which switches the mMyCommViewStack index to 2 (website browser).
			 */
			private function RegularExpressionEditorBackClickedHandler(event:Event):void
			{
				mMyCommViewStack.selectedIndex = 2;
			}
			
			/**
			 * 	Detects a request to create a community group. It will fire an event to notify
			 * 	that a community group should be created.
			 */
			private function createCommunityGroupHandler(event:cCreateCommunityGroupEvent):void
			{
				var e:cCreateCommunityGroupEvent = new cCreateCommunityGroupEvent("CreateCommunityGroupEvent");
				e.mCommName = event.mCommName;
				e.mKeywords = event.mKeywords;
				this.dispatchEvent(e);
			}
			
		
			///////////////////////////////////////////////////////////////////////////////////
			//
			//						   CANVAS EVENT HANDLERS
			//
			///////////////////////////////////////////////////////////////////////////////////
			
			/**
			 * 	Detects a create community groups request from cMyCommHomeCanvas and
			 *  opens the create community group canvas.
			 */
			private function openCreateCommGroupCanvasHandler(event:Event):void
			{
				mMyCommViewStack.selectedIndex = 1;
			}
			
			/**
			 * 	Detects request to view a particular community group and launches the community
			 *  group browser canvas.
			 */
			private function openCommunityGroupBrowserCanvasHandler(event:cCommGroupGraphicClickedEvent):void
			{
				mMyCommViewStack.selectedIndex = 2;
				mCommunityGroupBrowserCanvas.updateInformation(event.mCommGroupName,
															   event.mCommGroupId,
															   event.mCreator,
															   event.mTime.toString(),
															   event.mWebsites,
															   event.mKeywords);
			}
			
			/**
			 *	Detects request to view particular website statistics and fires a request to the engine.
			 */
			private function openWebsiteStatBrowserCanvasHandler(event:cWebsiteGraphicClickedEvent):void
			{
				var e:cWebsiteGraphicClickedEvent = new cWebsiteGraphicClickedEvent("RequestWebsiteStatsEvent");
				e.mWebsiteName = event.mWebsiteName;
				e.mCommGroupId = event.mCommGroupId;
				e.mWebsiteType = event.mWebsiteType;
				e.mWebsiteURL = event.mWebsiteURL;
				e.mWebsiteCreatedTime = event.mWebsiteCreatedTime;
				
				mWebsiteSelectedName = e.mWebsiteName;
				mWebsiteSelectedURL = e.mWebsiteURL;
				mWebsiteSelectedType = e.mWebsiteType;
				mWebsiteSelectedCreatedTime = e.mWebsiteCreatedTime;
				
				this.dispatchEvent(e);
			}
			
			/**
			 * 	Detects a request to open the create website window and fires a request to the main window.
			 */
			private function openWebsiteCreatorWindowHandler(event:cCreateWebsiteEvent):void
			{
				var e:cCreateWebsiteEvent = new cCreateWebsiteEvent("OpenWebsiteCreatorWindowEvent");
				e.mCommunityGroupId = event.mCommunityGroupId;
				this.dispatchEvent(e);
			}
			
			/**
			 *	Function which gets called each time this canvas is selected by the parent. It
			 * 	will select the cMyCommHomeCanvas as the default canvas within this component and
			 *  update its internal user information.
			 */
			private function showCanvasHandler(event:Event):void
			{					
				mMyCommHomeCanvas.updateInformation(mUserAccountInformation);				
				mMyCommViewStack.selectedIndex = 0;
			}
			
			/**
			 *	 Detects a request to open the regular expression editor canvas.
			 */
			private function editWebsiteLabelClickedHandler(event:cEditWebsiteEvent):void
			{
				mMyCommViewStack.selectedIndex = 4;
			}
			
			
			///////////////////////////////////////////////////////////////////////////////////
			//
			//						   MEMBER FUNCTIONS
			//
			///////////////////////////////////////////////////////////////////////////////////
			
			/**
			 * 	Function which updates the users information within this canvas component to be used
			 *  at a later time.
			 */
			public function updateInformation(userAccountInformation:cAccountInformation):void
			{
				mUserAccountInformation = userAccountInformation;	
			}
			
			/**
			 * 	Selects the website statistics browser canvas within the mMyCommViewStack.
			 */
			public function openWebsiteStatsBrowserCanvas(analyticsParser:cAnalyticsParser):void
			{
				//mMyCommViewStack.selectedIndex = 3;
				/*mWebsiteStatsBrowserCanvas.updateInformation(analyticsParser,
															 mWebsiteSelectedName,
															 mWebsiteSelectedURL,
															 mWebsiteSelectedType,
															 mWebsiteSelectedCreatedTime);*/
			}
			
			/**
			 * 	Calls the addWebsiteToVBoxes function in the cCommunityGroupBrowserCanvas.
			 */
			public function addWebsiteToCommGroupBrowerCanvas(websiteEntry:cWebsiteEntry):void {
				//mCommunityGroupBrowserCanvas.addWebsiteToVBoxes(websiteEntry);
			}
			
			/**
			 *  Selects the my community home canvas within the mMyCommViewStack.
			 *  Function used when this canvas has been selected in the past by
			 * 	mMyCommViewStack must be altered.
			 */
			public function openMyCommHomeCanvas():void
			{
				if(mMyCommViewStack != null) {
					mMyCommViewStack.selectedIndex = 0;
				}
			}
			
			
			///////////////////////////////////////////////////////////////////////////////////
			//
			//						   DATA MEMBERS
			//
			///////////////////////////////////////////////////////////////////////////////////
			
			// reference to the users community group information object
			private var mUserAccountInformation:cAccountInformation = null;
			
			// selected website information (temporary - changes each time a website is selected)
			private var mWebsiteSelectedName:String = "";
			private var mWebsiteSelectedURL:String = "";
			private var mWebsiteSelectedType:String = "";
			private var mWebsiteSelectedCreatedTime:String = "";
				
		]]>
	</mx:Script>
	<mx:ViewStack x="0" y="0" id="mNavigatorViewStack" width="1013" height="625">
		<mx:ViewStack id="mMyCommViewStack" label="My Community Groups" width="1013" height="625">
			<local:cMyCommHomeCanvas id="mMyCommHomeCanvas" show="showCanvasHandler(event)" OpenCommunityGroupBrowserCanvasEvent="openCommunityGroupBrowserCanvasHandler(event)" OpenCreateCommunityGroupCanvasEvent="openCreateCommGroupCanvasHandler(event)" label="My Community Groups" height="616" width="1012">
			</local:cMyCommHomeCanvas>
			<local:cCreateCommunityGroupCanvas id="mCreateCommunityGroupCanvas" CreateCommunityGroupEvent="createCommunityGroupHandler(event)" BackLabelClickedEvent="createCommBackLabelClickedHandler(event)" height="577" width="1003">
			</local:cCreateCommunityGroupCanvas>
			<local:cCommunityGroupBrowserCanvas id="mCommunityGroupBrowserCanvas" >
			</local:cCommunityGroupBrowserCanvas>
			<local:cRegularExpressionEditorCanvas id="mRegularExpressionEditorCanvas" BackLabelClickedEvent="RegularExpressionEditorBackClickedHandler(event)">
			</local:cRegularExpressionEditorCanvas>
		</mx:ViewStack>
		<mx:ViewStack id="mAllCommViewStack" label="All Community Groups" width="1013" height="585">
			<mx:Canvas label="All Community Groups" width="100%" height="100%" backgroundColor="#00D8FF">
			</mx:Canvas>
		</mx:ViewStack>
	</mx:ViewStack>
</mx:Canvas>
